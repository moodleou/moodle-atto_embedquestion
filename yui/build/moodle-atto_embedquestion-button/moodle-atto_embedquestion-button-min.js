YUI.add("moodle-atto_embedquestion-button",function(n,t){n.namespace("M.atto_embedquestion").Button=n.Base.create("button",n.M.editor_atto.EditorPlugin,[],{initializer:function(){var e;this.get("enablebutton")&&(this.addButton({icon:"icon",iconComponent:"atto_embedquestion",callback:this.displayDialogue}),this.get("host").on("atto:selectionchanged",function(){this.getEmbedCodeAtSelection()?this.highlightButtons():this.unHighlightButtons()},this),(e=this.getDialogue({headerContent:M.util.get_string("pluginname","atto_embedquestion"),width:"600px",focusAfterHide:!0},!0)).on("visibleChange",function(t){t.newVal||e.set("bodyContent","")}))},displayDialogue:function(){var e=this;require(["atto_embedquestion/dialogue_manager"],function(t){t.showDialogueFor(e)})},getEmbedCodeAtSelection:function(){var s,t,e=this.get("host").getSelectionParentNode(),u=this.get("host").getSelection(),d=!1;return!!e&&(!(!u||0===u.length)&&(u=u[0],!(!(t=(s=e.textContent).match(/\{Q\{(?:(?!\}Q\}).)*\}Q\}/g))||!t.length)&&(n.Array.find(t,function(t){for(var e,n,i,o,a=0;-1!==s.indexOf(t,a);){if(n=(e=s.indexOf(t,a))+t.length,i=u.startOffset>=e&&u.startOffset<n,o=u.endOffset<=n&&u.endOffset>e,i&&o)return d={start:e,end:n,embedCode:t},!0;a=n}return!1},this),d)))}},{ATTRS:{enablebutton:{value:!1},contextid:{value:!1},elementid:{value:!1}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});